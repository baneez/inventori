<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventori JPJ (M)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            background: linear-gradient(to bottom, #003399, #6699FF);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            margin: 0;
            padding-top: 50px;
            padding-bottom: 50px;
        }
        .container {
            background: #d6dbdf;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 1);
            width: 500px;
            text-align: center;
        }
        img {
            width: 80px;
            margin-bottom: 10px;
        }
        h2 {
            font-family: Arial, sans-serif;
            font-size: 20px;
            font-weight: bold;
        }
        label {
            display: block;
            text-align: left;
            font-weight: bold;
            margin-top: 15px;
        }
        select, input {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
            text-transform: uppercase;
        }
        button {
            width: 100%;
            padding: 10px;
            background: orange;
            color: blue;
            border: none;
            border-radius: 5px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 15px;
        }
        button:hover {
            background: yellow;
        }
        .dashboard-link {
            margin-top: 10px;
            font-weight: bold;
        }
        .note {
            font-size: 12px;
            margin-top: 10px;
            color: #555;
        }
    </style>
</head>
<body>

    <div class="container">
        <img src="https://i.postimg.cc/h4CXXqZd/JPJ-logo.png" alt="Logo JPJ">
        <h2>REKOD INVENTORI JPJ (M)</h2>

        <form id="myForm">
            <label for="negeri">NEGERI:</label>
            <select id="negeri" name="negeri">
                <option value="">PILIH NEGERI</option>
                <option value="HQ">HQ</option>
                <option value="JOHOR">JOHOR</option>
                <option value="KEDAH">KEDAH</option>
                <option value="KELANTAN">KELANTAN</option>
                <option value="MELAKA">MELAKA</option>
                <option value="NEGERI SEMBILAN">NEGERI SEMBILAN</option>
                <option value="PAHANG">PAHANG</option>
                <option value="PERAK">PERAK</option>
                <option value="PERLIS">PERLIS</option>
                <option value="PULAU PINANG">PULAU PINANG</option>
                <option value="SABAH">SABAH</option>
                <option value="SARAWAK">SARAWAK</option>
                <option value="SELANGOR">SELANGOR</option>
                <option value="TERENGGANU">TERENGGANU</option>
                <option value="WP KUALA LUMPUR">WP KUALA LUMPUR</option>
            </select>

            <label for="lokasi">LOKASI:</label>
            <select id="lokasi" name="lokasi">
                <option value="">PILIH LOKASI</option>
            </select>

            <label for="dokumen">DOKUMEN:</label>
            <select id="dokumen" name="dokumen">
                <option value="">PILIH DOKUMEN</option>
                <option value="LMM">LMM</option>
		<option value="LMM-PKN">LMM-PKN</option>    
                <option value="SLIP LMM">SLIP LMM</option>
		<option value="LDL">LDL</option>
		<option value="SLIP LDL">SLIP LDL</option>
		<option value="VOKASIONAL">VOKASIONAL</option>
		<option value="IDP">IDP</option>
            </select>

            <label for="transaksi">TRANSAKSI:</label>
            <select id="transaksi" name="transaksi">
                <option value="">PILIH TRANSAKSI</option>
                <option value="MASUK">MASUK</option>
                <option value="KELUAR">KELUAR</option>
		<option value="ROSAK">ROSAK</option>
            </select>

            <label for="kuantiti">KUANTITI:</label>
            <input type="number" id="kuantiti" name="kuantiti">

            <label for="tarikh">TARIKH:</label>
            <input type="date" id="tarikh" name="tarikh">

            <label for="nama_penyedia">NAMA PENYEDIA:</label>
            <input type="text" id="nama_penyedia" name="nama_penyedia" oninput="convertToUpper(this)">

            <button type="button" id="submitBtn">SUBMIT</button>
        </form>

        <div class="dashboard-link">
            <a href="https://your-dashboard-link.com" target="_blank">DASHBOARD</a>
        </div>

        <div class="note">
            * Pastikan semua maklumat diisi dengan lengkap sebelum dihantar.
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Auto-uppercase untuk Nama Penyedia
            function convertToUpper(input) {
                input.value = input.value.toUpperCase();
            }

            // Set default tarikh ke hari ini
            document.getElementById("tarikh").valueAsDate = new Date();

            // Data Negeri & Lokasi
            const lokasiData = {
                "HQ": ["STOR PUSAT"],
				"JOHOR": ["BATU PAHAT", "JOHOR BHARU", "KLUANG", "MERSING", "MOBILE JOHOR", "MUAR", "PONTIAN", "SEGAMAT", "UTC KOTA RAYA", "UTC PASIR GUDANG"],
				"KEDAH": ["ALOR SETAR", "ANAK BUKIT", "BALING", "KULIM", "LANGKAWI", "MOBILE KEDAH", "STOR UTAMA", "SUNGAI PETANI", "UTC ALOR SETAR", "UTC SUNGAI PETANI"],
				"KELANTAN": ["GUA MUSANG", "KOTA BHARU", "MACHANG", "MOBILE KELANTAN 533", "STOR UTAMA", "UTC KELANTAN"],
				"MELAKA": ["JASIN", "MASJID TANAH", "MELAKA TENGAH", "MOBILE MELAKA 511", "STOR UTAMA", "UTC MELAKA"],
				"NEGERI SEMBILAN": ["JEMPOL", "KUALA PILAH", "MOBILE K1", "SEREMBAN", "STOR UTAMA", "UTC SEREMBAN"],
				"PAHANG": ["BANDAR MUADZAM SHAH", "BENTONG", "CAMERON HIGHLAND", "JENGKA", "KUANTAN", "MOBILE PAHANG", "RAUB", "STOR UTAMA", "TEMERLOH", "UTC KUANTAN"],
				"PERAK": ["GERIK", "IPOH", "MOBILE IPOH", "MOBILE PERAK 6776", "SP KUALA KANGSAR", "SRI MANJUNG", "STOR UTAMA", "TAIPING", "TAPAH", "TELUK INTAN", "UTC IPOH"],
				"PERLIS": ["ARAU", "MOBILE PERLIS", "STOR UTAMA", "UTC PERLIS"],
				"PULAU PINANG": ["BATU UBAN", "MOBILE PULAU PINANG 233", "SEBERANG JAYA", "STOR UTAMA", "UTC KOMTAR"],
				"SABAH": ["BEAUFORT", "KENINGAU", "KOTA BELUD", "KOTA KINABALU", "KOTA MARUDU", "KUDAT", "LABUAN", "LAHAD DATU", "MOBILE KINABALU", "MOBILE SANDAKAN", "PANDU LALU", "PAPAR", "RANAU", "SANDAKAN", "SEMPORNA", "SIPITANG", "STOR UTAMA", "TAMBUNAN", "TAWAU", "TENOM", "TUARAN", "UTC KENINGAU", "UTC KOTA KINABALU", "UTC TAWAU"],
                "SARAWAK": ["BETONG", "BINTULU", "KAPIT", "KUCHING", "LAWAS", "LIMBANG", "MIRI", "MOBILE BINTULU", "MOBILE MIRI", "MOBILE TRUCK KUCHING", "MOBILE VAN KUCHING", "MUKAH", "SARIKEI", "SERIAN", "SIBU", "SRI AMAN", "STOR UTAMA", "UTC KUCHING", "UTC MIRI", "UTC SIBU"],
				"SELANGOR": ["BANGI", "BANTING", "KUALA KUBU BARU", "KUALA SELANGOR", "MOBILE SELANGOR 4884", "PADANG JAWA", "PETALING JAYA", "SABAK BERNAM", "STOR UTAMA", "UTC SHAH ALAM"],
                "TERENGGANU": ["BESUT", "KEMAMAN", "KUALA TERENGGANU", "MOBILE TERENGGANU 433", "STOR UTAMA", "UTC TERENGGANU"],
                "WP KUALA LUMPUR": ["BANDAR SRI PERMAISURI", "GALERIA PUTRAJAYA", "KUALA LUMPUR", "MANJALARA", "MOBILE PUTRAJAYA 211", "MOBILE WPKL 4554", "UTC KERAMAT", "UTC PUDU", "UTC SENTUL"]
            };

            function updateLokasi() {
                const negeriSelect = document.getElementById("negeri");
                const lokasiSelect = document.getElementById("lokasi");

                lokasiSelect.innerHTML = '<option value="">PILIH LOKASI</option>';

                if (lokasiData[negeriSelect.value]) {
                    lokasiData[negeriSelect.value].forEach(lokasi => {
                        let option = document.createElement("option");
                        option.value = lokasi;
                        option.textContent = lokasi;
                        lokasiSelect.appendChild(option);
                    });
                }
            }

            document.getElementById("negeri").addEventListener("change", updateLokasi);

            // Validasi Form & Hantar ke Google Sheets
            function validateForm() {
                const formData = new FormData(document.getElementById("myForm"));

                for (let pair of formData.entries()) {
                    if (!pair[1]) {
                        alert("DATA TIDAK LENGKAP");
                        return;
                    }
                }

                fetch("https://script.google.com/macros/s/AKfycbwSwIKoR5AAp1cMxO2EIknjrqBGf7NxddtMrZujbX0sYe8ki3xS9Q7KMnYo8Nv5hK9v/exec", {
                    method: "POST",
                    body: formData
                })
                .then(response => response.text())
                .then(data => {
                    if (data.trim() === "SUCCESS") {
                        alert("REKOD BERJAYA");
                        document.getElementById("myForm").reset();
                        document.getElementById("tarikh").valueAsDate = new Date();
                    } else {
                        alert("GAGAL MENYIMPAN DATA");
                    }
                })
                .catch(error => console.error("Error:", error));
            }

            document.getElementById("submitBtn").addEventListener("click", validateForm);
        });
    </script>

</body>
</html>
